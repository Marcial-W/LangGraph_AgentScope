# -*- coding: utf-8 -*-
"""
å†…å®¹ç”Ÿæˆæ™ºèƒ½ä½“ (Content Agent)
è´Ÿè´£ç”Ÿæˆæ–‡æ¡ˆã€å›¾æ–‡ã€è§†é¢‘ã€äº’åŠ¨å¸–ç­‰å¤šæ¨¡æ€å†…å®¹
"""

from agentscope.agent import Agent
from agentscope.message import Message
from typing import Dict, List, Any
import json
import random


class ContentAgent(Agent):
    """å†…å®¹ç”Ÿæˆæ™ºèƒ½ä½“ - è´Ÿè´£å†…å®¹åˆ¶ä½œç»„çš„è§’è‰²"""
    
    def __init__(self, name: str = "content_agent", **kwargs):
        super().__init__(name=name, **kwargs)
        self.content_templates = {
            "å¾®åš": {
                "å­—æ•°é™åˆ¶": 140,
                "ç‰¹ç‚¹": "ç®€æ´æœ‰åŠ›ï¼Œè¯é¢˜æ ‡ç­¾"
            },
            "å°çº¢ä¹¦": {
                "å­—æ•°é™åˆ¶": 1000,
                "ç‰¹ç‚¹": "å›¾æ–‡å¹¶èŒ‚ï¼Œç”Ÿæ´»åŒ–"
            },
            "æŠ–éŸ³": {
                "æ—¶é•¿é™åˆ¶": "15-60ç§’",
                "ç‰¹ç‚¹": "è§†è§‰å†²å‡»ï¼ŒéŸ³ä¹èŠ‚å¥"
            }
        }
        
    def reply(self, message: Message) -> Message:
        """å¤„ç†å†…å®¹ç”Ÿæˆè¯·æ±‚"""
        content = message.content if isinstance(message.content, str) else str(message.content)
        
        # è§£æå†…å®¹éœ€æ±‚
        if "æ–‡æ¡ˆ" in content:
            response = self._generate_copywriting(content)
        elif "å›¾æ–‡" in content:
            response = self._generate_image_text(content)
        elif "è§†é¢‘" in content:
            response = self._generate_video_script(content)
        elif "äº’åŠ¨" in content:
            response = self._generate_interactive_post(content)
        else:
            response = self._generate_multimodal_content(content)
            
        return Message(
            role="assistant",
            name=self.name,
            content=response
        )
    
    def _generate_copywriting(self, request: str) -> str:
        """ç”Ÿæˆè¥é”€æ–‡æ¡ˆ"""
        platform = self._detect_platform(request)
        
        copywriting_examples = {
            "å¾®åš": [
                "ğŸ”¥ å½“AIé‡ä¸Šç”Ÿæ´»ï¼Œæ¯ä¸€å¤©éƒ½æ˜¯æ™ºèƒ½æ–°ä½“éªŒï¼#AIç”Ÿæ´» #æ™ºèƒ½ç§‘æŠ€ #æœªæ¥å·²æ¥",
                "ğŸ’¡ å‘Šåˆ«ç¹çï¼Œè®©AIæˆä¸ºä½ çš„ç”Ÿæ´»åŠ©æ‰‹ï½ä»Šå¤©ä½ AIäº†å—ï¼Ÿ#æ™ºèƒ½ç”Ÿæ´» #ç§‘æŠ€æ”¹å˜ç”Ÿæ´»"
            ],
            "å°çº¢ä¹¦": [
                "å§å¦¹ä»¬ï¼å‘ç°äº†ä¸€ä¸ªè¶…æ™ºèƒ½çš„ç”Ÿæ´»ç¥å™¨ğŸŒŸ\n\nâœ¨ æ™ºèƒ½è¯†åˆ«éœ€æ±‚\nâœ¨ ä¸ªæ€§åŒ–æ¨èæ–¹æ¡ˆ\nâœ¨ 24å°æ—¶è´´å¿ƒæœåŠ¡\n\nç”¨äº†ä¸€å‘¨ï¼Œæ„Ÿè§‰ç”Ÿæ´»å“è´¨éƒ½æå‡äº†ï¼çœŸå¿ƒæ¨èç»™è¿½æ±‚å“è´¨ç”Ÿæ´»çš„ä½ ä»¬ï½\n\n#æ™ºèƒ½ç”Ÿæ´» #å“è´¨ç”Ÿæ´» #ç§‘æŠ€å¥½ç‰©"
            ],
            "æŠ–éŸ³": [
                "ã€15ç§’çŸ­è§†é¢‘æ–‡æ¡ˆã€‘\nå¼€åœºï¼šè¿˜åœ¨ä¸ºXXçƒ¦æ¼å—ï¼Ÿ\nå±•ç¤ºï¼šä¸€é”®è§£å†³ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼\nç»“å°¾ï¼šGetåŒæ¬¾ï¼Œè¯„è®ºåŒºé“¾æ¥ğŸ”—"
            ]
        }
        
        platform_key = platform if platform in copywriting_examples else "å¾®åš"
        selected = random.choice(copywriting_examples[platform_key])
        
        return f"âœï¸ {platform}æ–‡æ¡ˆç”Ÿæˆï¼š\n\n{selected}\n\n[æç¤ºï¼šå·²æ ¹æ®å¹³å°ç‰¹æ€§ä¼˜åŒ–å­—æ•°å’Œé£æ ¼]"
    
    def _generate_image_text(self, request: str) -> str:
        """ç”Ÿæˆå›¾æ–‡å†…å®¹"""
        image_text = {
            "æ ‡é¢˜": "ç”¨AIå¼€å¯æ™ºèƒ½ç”Ÿæ´»æ–°çºªå…ƒ",
            "å›¾ç‰‡å»ºè®®": [
                "å›¾1ï¼šäº§å“ä½¿ç”¨åœºæ™¯å›¾ï¼ˆæ¸©é¦¨å®¶å±…ç¯å¢ƒï¼‰",
                "å›¾2ï¼šåŠŸèƒ½ç‰¹æ€§å¯¹æ¯”å›¾ï¼ˆç›´è§‚å±•ç¤ºä¼˜åŠ¿ï¼‰",
                "å›¾3ï¼šç”¨æˆ·å¥½è¯„æˆªå›¾ï¼ˆå¢å¼ºä¿¡ä»»åº¦ï¼‰"
            ],
            "æ­£æ–‡": """
åœ¨è¿™ä¸ªå¿«èŠ‚å¥çš„æ—¶ä»£ï¼Œæˆ‘ä»¬éƒ½åœ¨å¯»æ‰¾è®©ç”Ÿæ´»æ›´è½»æ¾çš„æ–¹å¼ã€‚

ä»Šå¤©æƒ³å’Œå¤§å®¶åˆ†äº«æˆ‘çš„æ™ºèƒ½ç”Ÿæ´»æ–°å‘ç°â€”â€”

ğŸ  æ™ºèƒ½å®¶å±…æ§åˆ¶
åªéœ€ä¸€å¥è¯ï¼Œç¯å…‰ã€æ¸©åº¦ã€éŸ³ä¹éšå¿ƒè°ƒèŠ‚

ğŸ“± ä¸ªæ€§åŒ–æ¨è
åŸºäºä½ çš„å–œå¥½ï¼Œæ¨èæœ€é€‚åˆçš„ç”Ÿæ´»æ–¹æ¡ˆ

â° æ™ºèƒ½æ—¶é—´ç®¡ç†
åˆç†è§„åˆ’æ¯ä¸€å¤©ï¼Œå·¥ä½œç”Ÿæ´»ä¸¤ä¸è¯¯

æœ€æ‰“åŠ¨æˆ‘çš„æ˜¯å®ƒçœŸçš„æ‡‚ä½ æƒ³è¦ä»€ä¹ˆï¼Œä¸æ˜¯å†·å†°å†°çš„æœºå™¨ï¼Œæ›´åƒæ˜¯è´´å¿ƒçš„ç”Ÿæ´»ç®¡å®¶ã€‚

ä½ ä»¬æœ‰ä»€ä¹ˆæ™ºèƒ½å¥½ç‰©æ¨èå—ï¼Ÿè¯„è®ºåŒºäº¤æµå‘€ï½
""",
            "é…å›¾è¯´æ˜": "å»ºè®®é…3-6å¼ é«˜è´¨é‡å®æ‹å›¾ï¼Œå±•ç¤ºäº§å“ç»†èŠ‚å’Œä½¿ç”¨åœºæ™¯"
        }
        
        return f"ğŸ–¼ï¸ å›¾æ–‡å†…å®¹æ–¹æ¡ˆï¼š\n{json.dumps(image_text, ensure_ascii=False, indent=2)}"
    
    def _generate_video_script(self, request: str) -> str:
        """ç”Ÿæˆè§†é¢‘è„šæœ¬"""
        video_script = {
            "æ—¶é•¿": "30ç§’",
            "åœºæ™¯åˆ—è¡¨": [
                {
                    "æ—¶é—´": "0-5ç§’",
                    "ç”»é¢": "é—®é¢˜åœºæ™¯ï¼šç”¨æˆ·é¢å¯¹ç¹ççš„æ—¥å¸¸ä»»åŠ¡",
                    "æ–‡æ¡ˆ": "æ¯å¤©éƒ½åœ¨é‡å¤è¿™äº›çäº‹ï¼Ÿ",
                    "éŸ³æ•ˆ": "è½»å¿«èƒŒæ™¯éŸ³ä¹"
                },
                {
                    "æ—¶é—´": "5-20ç§’",
                    "ç”»é¢": "è§£å†³æ–¹æ¡ˆå±•ç¤ºï¼šAIäº§å“ä½¿ç”¨æ¼”ç¤º",
                    "æ–‡æ¡ˆ": "æœ‰äº†å®ƒï¼Œä¸€åˆ‡å˜å¾—å¦‚æ­¤ç®€å•",
                    "éŸ³æ•ˆ": "èŠ‚å¥æ„Ÿå¢å¼º"
                },
                {
                    "æ—¶é—´": "20-30ç§’",
                    "ç”»é¢": "æ•ˆæœå±•ç¤ºï¼šç”¨æˆ·è½»æ¾æ„‰å¿«çš„ç”Ÿæ´»çŠ¶æ€",
                    "æ–‡æ¡ˆ": "æ™ºèƒ½ç”Ÿæ´»ï¼Œä»ç°åœ¨å¼€å§‹",
                    "éŸ³æ•ˆ": "æ¸©é¦¨ç»“å°¾éŸ³"
                }
            ],
            "æ‹æ‘„è¦ç‚¹": "æ³¨é‡ç”»é¢è½¬åœºæµç•…æ€§ï¼Œçªå‡ºäº§å“æ˜“ç”¨æ€§"
        }
        
        return f"ğŸ¬ è§†é¢‘è„šæœ¬ï¼š\n{json.dumps(video_script, ensure_ascii=False, indent=2)}"
    
    def _generate_interactive_post(self, request: str) -> str:
        """ç”Ÿæˆäº’åŠ¨å¸–å†…å®¹"""
        interactive_post = {
            "ç±»å‹": "æŠ•ç¥¨äº’åŠ¨",
            "ä¸»é¢˜": "ä½ æœ€æœŸå¾…çš„AIåŠŸèƒ½æ˜¯ï¼Ÿ",
            "é€‰é¡¹": [
                "A. æ™ºèƒ½è¯­éŸ³åŠ©æ‰‹",
                "B. ä¸ªæ€§åŒ–æ¨è",
                "C. è‡ªåŠ¨åŒ–ä»»åŠ¡å¤„ç†",
                "D. æƒ…æ„Ÿé™ªä¼´"
            ],
            "å¼•å¯¼è¯­": "å¿«æ¥æŠ•ç¥¨ï¼Œè¯„è®ºåŒºè¯´è¯´ä½ çš„æƒ³æ³•ï½æŠ½3ä½é€æ™ºèƒ½å¥½ç¤¼ğŸ",
            "é¢„æœŸæ•ˆæœ": "æé«˜ç”¨æˆ·å‚ä¸åº¦ï¼Œæ”¶é›†ç”¨æˆ·éœ€æ±‚"
        }
        
        return f"ğŸ’¬ äº’åŠ¨å¸–æ–¹æ¡ˆï¼š\n{json.dumps(interactive_post, ensure_ascii=False, indent=2)}"
    
    def _generate_multimodal_content(self, request: str) -> str:
        """ç”Ÿæˆå¤šæ¨¡æ€ç»¼åˆå†…å®¹"""
        content_package = {
            "å†…å®¹ç»„åˆ": "å›¾æ–‡+çŸ­è§†é¢‘+äº’åŠ¨è¯é¢˜",
            "å‘å¸ƒç­–ç•¥": "åˆ†æ—¶æ®µã€å¤šå¹³å°è”åŠ¨å‘å¸ƒ",
            "æ ¸å¿ƒå–ç‚¹": "AIè®©ç”Ÿæ´»æ›´ç¾å¥½",
            "é£æ ¼è°ƒæ€§": "ç§‘æŠ€æ„Ÿ+æ¸©åº¦æ„Ÿå¹¶å­˜"
        }
        
        return f"ğŸ¨ å¤šæ¨¡æ€å†…å®¹åŒ…ï¼š\n{json.dumps(content_package, ensure_ascii=False, indent=2)}"
    
    def _detect_platform(self, content: str) -> str:
        """æ£€æµ‹ç›®æ ‡å¹³å°"""
        platforms = ["å¾®åš", "å°çº¢ä¹¦", "æŠ–éŸ³"]
        for platform in platforms:
            if platform in content:
                return platform
        return "å¾®åš"  # é»˜è®¤å¹³å°
